---
title: "Akkermansia muciniphila"
author: Jessica Hunter
date: May 10, 2022
output:
  prettydoc::html_pretty:
    theme: hpstr
    highlight: github
---

```{r setup, include=FALSE}
library(flexdashboard)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, error = FALSE)
```




```{r, results='hide', include=FALSE}
library(tidyverse)
library(here)
library(janitor)
library(wordcloud)
library(reshape2)
library(magick)
```
# Background

-----

### *Akkermansia muciniphila*


-----
```{r echo=FALSE}
amucem<- image_read(here("finalproject", "data", "EMamuc.png"))
amucem
```
---

* Akkermansia muciniphila is a mucin-loving microbe that usuaally represents 1 to 5%  of our intestinal microbes. It's mucin preference thickens our gut barrier.

* It improves glucose intolerance and insulin resistance to inprove diabetic symptoms. 

* It reduces high-fat-diet weight gain and reduces inflammation.

----

```{r echo=FALSE}
amucobesity<- image_read(here("finalproject","data", "amucobesity.jpg"))
amucobesity
```
---

## Data source

---


### Study Details regarding Sample Aquisition

#### "Dietary Habits are associated with Gut Composition"

[https://doi.org/10.1016/j.jand.2019.07.024](https://doi.org/10.1016/j.jand.2019.07.024)  

Samples came from:   
- 130 children ages 3-9  
- from suburban Los Angeles  
- Between June and September 2014  

---

## My Project:

#### "Designing a multiplex PCR assay to detect the different strains of *A. muciniphila*"

```{r echo=FALSE}
mpex <- image_read(here("finalproject", "data", "multiplexexample.png"))
mpex

```

- Designed primers to amplify exclusive sequences of different lengths from each strain

---

## Results

#### Testing with controls

```{r echo=FALSE}
control <- image_read(here("finalproject", "data", "control.jpg"))
control
```

---

#### Some of the actual results

```{r echo=FALSE}
results <- image_read(here("finalproject", "data", "results.jpg"))
results
```

---

##### More actual results
```{r echo=FALSE}
zoomout <- image_read(here("finalproject", "data", "zoomedout.jpg"))
zoomout
```

---

#### This person has 2 strains

```{r echo=FALSE}
zoom <- image_read(here("finalproject", "data", "zoom.jpg"))
zoom
```

---
 
```{r, include=FALSE}
seq16sclean1 <- read_csv(here("finalproject", "data", "CDI_Samples_Akkermansia_16S.csv")) %>% 
  clean_names() %>%
   select(sample_id = taxon,
         amuc16s = akkermansia_ra_16s,
         am_i, am_ii, am_iii, am_iv,
         dna_conc = dna_concentration) %>% 
  mutate(am_i, am_i = if_else(am_i == "+++", 4,
                                 if_else(am_i == "++", 3,
                                 if_else(am_i == "+", 2,
                                 if_else(am_i == "+/-", 1,
                                 if_else(am_i == "-", 0, 0)))))) %>% 
  mutate(am_ii, am_ii = if_else(am_ii == "+++", 4,
                                 if_else(am_ii == "++", 3,
                                 if_else(am_ii == "+", 2,
                                 if_else(am_ii == "+/-", 1,
                                 if_else(am_ii == "-", 0, 0)))))) %>% 
  mutate(am_iii, am_iii = if_else(am_iii == "+++", 4,
                                 if_else(am_iii == "++", 3,
                                 if_else(am_iii == "+", 2,
                                 if_else(am_iii == "+/-", 1,
                                 if_else(am_iii == "-", 0, 0)))))) %>% 
  mutate(am_iv, am_iv = if_else(am_iv == "+++", 4,
                                 if_else(am_iv == "++", 3,
                                 if_else(am_iv == "+", 2,
                                 if_else(am_iv == "+/-", 1,
                                 if_else(am_iv == "-", 0, 0)))))) %>% 
  mutate(ampercent = str_replace_all(amuc16s,"%", ""),
         dna_conc = as.numeric(dna_conc),
         ampercent = as.numeric(ampercent))

clean16s2 <-seq16sclean1 %>% 
  drop_na()


clean16slong <- clean16s2 %>% 
  select(!am_iii) %>% 
  pivot_longer(cols = am_i:am_iv, names_to = "Strain",
               values_to = "value") %>% 
  filter(value != 0) %>% 
  mutate(Strain = if_else(Strain == "am_i", "AmI",
                          if_else(Strain == "am_ii", "AmII", "AmIII"))) 


g1<- clean16s2 %>% 
  filter(am_i >0,
         ampercent > 0.1) %>% 
  mutate(totaldna = dna_conc * ampercent/100) 
   

g2<- clean16s2 %>% 
  filter(am_ii > 0,
         ampercent > 0.1) %>% 
  mutate(totaldna = dna_conc * ampercent/100) 
    


g4 <- clean16s2 %>% 
  filter(am_iv > 0,
         ampercent > 0.1) %>% 
  mutate(totaldna = dna_conc * ampercent/100) 
    
```


---

# Data Visualizations 

### Total DNA needed to detect A. muciniphila

```{r echo=FALSE}
ggplot()+
  geom_jitter(g2, mapping = aes(x=am_ii,y = totaldna), colour = "steelblue", width = 0.25)+
  geom_jitter(g1, mapping = aes(x=am_i, y = totaldna), colour = "red", width =0.25)+
   geom_jitter(g4, mapping = aes(x=am_iv,y = totaldna),colour = "purple", width = 0.25)+
  labs(x = "PCR detection band strength",
       y = "DNA in ng")
```



----------

This shows the amount of nanograms of geonomic DNA that were present for detection. 

As the amount of DNA is increased the band strength is stronger

------------

### This is the relative percent of A.muciniphila present for each of the samples out of the total gut community 

```{r echo=FALSE}
ggplot(clean16slong, mapping = aes(x = Strain, y = ampercent, color = Strain))+
  geom_jitter()+
  labs(y = "Percent relative abundance")
```





------------

# Nutritional

```{r, include=FALSE}

q1 <- read_csv(here("finalproject","data","questg1.csv")) %>% 
  clean_names() %>% 
  select(idnumber = order,
         am1=phylogroup)
q2 <- read_csv(here("finalproject","data","questg2.csv")) %>% 
  clean_names() %>% 
  select(idnumber = order,
         am2 = phylogroup)
q4 <- read_csv(here("finalproject","data","questg4.csv")) %>% 
  clean_names() %>% 
  select(idnumber = order,
         am4 = phylogroup)
q0 <- read_csv(here("finalproject","data","questg0.csv")) %>% 
  clean_names() %>% 
  select(idnumber = order,
         am0 =phylogroup)

diet2 <- read_csv((here("finalproject", "data", "dietdata.csv"))) %>%
  clean_names()%>%
  mutate(idnumber = as.numeric(str_replace_all(personal_id, "[^[:digit:]]", ""))) %>%
  select(idnumber)

qall <- full_join(diet2, q0, by = "idnumber") %>% 
  full_join(q1, by = "idnumber") %>% 
  full_join(q2) %>% 
  full_join(q4)

diet <- read_csv((here("finalproject", "data", "dietdata.csv"))) %>% 
  clean_names()%>% 
  mutate(idnumber = as.numeric(str_replace_all(personal_id, "[^[:digit:]]", ""))) %>% 
  left_join(qall) %>% 
  pivot_longer(cols = am0:am4, names_to = "phylo", values_to = "am_number",
               values_drop_na = TRUE) %>% 
  select(idnumber, sex, age, 
         fruit_total, grains_total, vegetable_total, dairy_total,
         carbpercent = percent_kcal_from_carbohydrate,
         fatpercent = percent_kcal_from_fat,
         protpercent = percent_kcal_from_protein,
         am_number)

dietlong<- diet %>% 
  pivot_longer(cols = carbpercent:protpercent, names_to= "type",
               values_to = "percentvalue")
```




### Nutritional Breakdown of meals consumed within 24 hours of sample being taken

```{r echo=FALSE}
ggplot(dietlong, aes(x= am_number,
                 y=percentvalue,
             color = type))+
  geom_point(position = position_jitterdodge())+
  labs(x= "Type of Akkermansia",
       y = "Percent of Nutrients Consumed")
```


---------

There are slight diet differences among the different strains and those that have none

-------

```{r}
diet3 <- read_csv((here("finalproject", "data", "dietdata.csv"))) %>% 
  clean_names()%>% 
  mutate(idnumber = as.numeric(str_replace_all(personal_id, "[^[:digit:]]", ""))) %>% 
  left_join(qall) %>% 
  pivot_longer(cols = am0:am4, names_to = "phylo", values_to = "am_number",
               values_drop_na = TRUE)%>% 
  mutate(phylo = if_else(phylo == "am0", "none",
                          if_else(phylo == "am2", "AmII",
                                  if_else(phylo == "am4", "AmIV", "AmI")))) %>%
  pivot_longer(cols = protein_animal:seafood_low_fa, names_to = "MeatType") %>% 
  select(phylo, MeatType, value) %>% 
  filter(value != 0)

ggplot(diet3, aes(x= phylo, y = value, color = MeatType))+
  geom_point(position = position_jitterdodge())+
  labs(x= "Akkermansia Type", y = "kcal")
```

----

#### This graph shows the income distribution of the households that have Akkermansia and those that dont

```{r, include=FALSE}
q1income <- read_csv(here("finalproject","data","questg1.csv")) %>% 
  clean_names() %>% 
  select(idnumber = order,
         phylogroup, max_income)
q2income <- read_csv(here("finalproject","data","questg2.csv")) %>% 
  clean_names() %>% 
  select(idnumber = order,
         phylogroup, max_income)
q4income <- read_csv(here("finalproject","data","questg4.csv")) %>% 
  clean_names() %>% 
  select(idnumber = order,
         phylogroup, max_income)

incomeamuc <- q1income %>% 
  full_join(q2income) %>% 
  full_join(q4income) %>% 
  drop_na()


q0income <- read_csv(here("finalproject","data","questg0.csv")) %>% 
  clean_names() %>% 
  select(idnumber = order,
         phylogroup, max_income) %>% 
  drop_na()

bothincome<- incomeamuc %>% 
  full_join(q0income) %>% 
  mutate(presence = if_else(phylogroup=="Am0", "Not present", "Present"))
```


```{r}
 ggplot(bothincome, mapping = aes(x= presence, y = max_income, fill = presence))+
   geom_violin()+
  labs(x= "Presence of Akkermansia",
       y = "Maximun Imcome in USD")
```

--- 

#### This shows the foods and vitamins associated with those that have *Akkermansia* and those that don't


```{r echo=FALSE}
dietwords <- read_csv((here("finalproject", "data", "dietdata.csv"))) %>% 
  clean_names()%>% 
  mutate(idnumber = as.numeric(str_replace_all(personal_id, "[^[:digit:]]", ""))) %>% 
  left_join(qall) %>% 
  select(!c(kcal,percent_kcal_from_carbohydrate, percent_kcal_from_protein, percent_kcal_from_fat, dairy_total, 1:3)) %>% 
  pivot_longer(cols = am0:am4, names_to = "phylo", values_to = "am_number",
               values_drop_na = TRUE) %>% 
  mutate(presence = if_else(phylo == "am0", "No Amuc", "Amuc Present")) %>% 
  select(!59:61) %>% 
  group_by(presence) %>% 
  summarise_if(is.numeric, mean, na.rm = TRUE) %>% 
   pivot_longer(cols= !presence, names_to = "type") %>% # making the data back long for my plot
    filter(value!=0) %>%  # removing the empty values
  drop_na() %>% 
  acast(type~presence, value.var = "value", fill = 0) %>% 
  comparison.cloud(colors = c("darkorange", "blue"), # colors for my word cloud 
                   max.words = 100, random.order = FALSE, title.size = 2, rot.per = .3, scale = c(4, 1))

```

----

# References

1. Plovier H, Everard A, Druart C, Depommier C, Van Hul M, Geurts L, Chilloux J, Ottman N, Duparc T, Lichtenstein L, Myridakis A, Delzenne NM, Klievink J, Bhattacharjee A, van der Ark KCH, Aalvink S, Martinez LO, Dumas M-E, Maiter D, Loumaye A, Hermans MP, Thissen J-P, Belzer C, de Vos WM, Cani PD. 2017. A purified membrane protein from Akkermansia muciniphila or the pasteurized bacterium improves metabolism in obese and diabetic mice. Nat Med 23:107–113.
2. Why Gut Health Matters. Lifeway Kefir. https://lifewaykefir.com/why-gut-health-matters/. 
3. Herman DR, Rhoades N, Mercado J, Argueta P, Lopez U, Flores GE. 2020. Dietary Habits of 2- to 9-Year-Old American Children Are Associated with Gut Microbiome Composition. Journal of the Academy of Nutrition and Dietetics 120:517–534.
4. Cani PD, de Vos WM. 2017. Next-Generation Beneficial Microbes: The Case of Akkermansia muciniphila. Frontiers in Microbiology 8.
5.  Figure 3. Electron microscope images of A. muciniphila. Images by... ResearchGate. https://www.researchgate.net/figure/Electron-microscope-images-of-A-muciniphila-Images-by-Justus-Reunanen-University-of_fig3_283273102. 


---

# Thank you, 
## Any Questions?
```{r echo=FALSE}
happy <- image_read(here("finalproject", "data", "happygut.png"))
happy
```


---
